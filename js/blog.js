/* ============================================
   BLOG JAVASCRIPT
   Handles markdown parsing and blog functionality
   ============================================ */

// Blog post data - this would typically come from a build process
// For simplicity, we define posts here that can be easily updated
const BLOG_POSTS = [
  {
    slug: '2024-12-15-holiday-wellness',
    title: 'Holiday Wellness for Women: Staying Grounded Without Extremes',
    date: '2024-12-15',
    author: 'Alicia',
    excerpt: 'The holidays tend to bring a lot to the surface. Not because anyone is doing something wrong — but because life gets fuller all at once.',
    image: '/images/blog/holiday-wellness.jpeg',
    categories: ['wellness', 'foundations'],
    content: `
# Holiday Wellness for Women: Staying Grounded Without Extremes

The holidays tend to bring a lot to the surface. Not because anyone is doing something wrong — but because life gets fuller all at once.

Routines naturally shift during busy holiday weeks, and it can be tempting to fall into extremes: either perfectionism about maintaining every health habit, or completely abandoning wellness practices until January.

## Finding Your Middle Ground

There's a better way. Instead of the false choice between rigidity and abandonment, focus on finding small ways to stay supported within the season you're actually living in.

### Managing Pressure and Self-Criticism

The holidays often come with internal pressure — expectations about how things should look, feel, or go. Notice when you're being hard on yourself and practice gentle awareness instead of judgment.

### Choose 1-2 Portable Health Anchors

You don't need to maintain every routine. Pick one or two practices that travel well and help you feel like yourself:
- Your morning supplements
- A short walk after meals
- Staying hydrated
- Getting to bed at a reasonable hour

### Approach Food Without Guilt

Holiday eating doesn't require compensation or punishment. Enjoy meals mindfully without calculating how you'll "make up for it" later. Your body knows how to handle seasonal variation.

### Gentle Awareness Around Alcohol and Sweets

You don't have to say no to everything, but checking in with yourself helps. Are you reaching for another drink or cookie because you want it, or because it's there? Either answer is okay — the awareness matters.

### Prioritize Rest

Support your circadian rhythm even during busy times:
- Get morning light when possible
- Keep bedtime relatively consistent
- Rest when you can, even if it's imperfect

### Movement That Feels Supportive

Movement during the holidays should feel good, not punitive. A walk with family, gentle stretching, or playing with kids all count. Skip the intense "burn off the pie" mentality.

### Value Joy and Connection

Remember that joy, laughter, and connection are wellness components too. Being fully present with people you love is as valuable as any supplement or workout.

## The Bottom Line

Wellness during the holidays doesn't require perfection, compensation, or January resets. It requires self-compassion and gentle consistency. You're doing better than you think.

Merry Christmas! Stay well my friends,
Alicia
    `
  },
  {
    slug: '2024-12-01-unmedicated-birth',
    title: 'How I Prepared for an Unmedicated Birth',
    date: '2024-12-01',
    author: 'Alicia',
    excerpt: 'My personal story, not medical advice. Preparing for an unmedicated birth wasn\'t about perfection—it was about intention.',
    image: '/images/blog/unmedicated-birth-new.png',
    categories: ['preconception'],
    content: `
# How I Prepared for an Unmedicated Birth

*My personal story, not medical advice*

Preparing for an unmedicated birth wasn't about perfection—it was about intention. It was about supporting my body and trusting my instincts, not proving anything through enduring labor pain. Here's how I prepared across physical, emotional, and spiritual dimensions.

## 1. Birthing Class

I attended Birthing Naturally (DFW) to understand labor physiology, advocacy, mental techniques, and partner support roles. Education was foundational—understanding the physiological process of birth helped me trust my body's ability to do what it was designed to do.

## 2. Physical Activity

I incorporated walking, weightlifting, and functional strength training throughout pregnancy. This wasn't about intense exercise—it was about building labor endurance and setting myself up for postpartum recovery.

## 3. Pelvic Floor Therapy

I worked with My Fit Pelvis-McKinney to develop relaxation techniques, breathing patterns, and personalized exercises optimizing pelvic mobility. Understanding my pelvic floor and how to work with it during labor was invaluable.

## 4. Mental Preparation

Birth is as much mental as physical. I utilized three meditation approaches:
- **Hypnobabies** hypnosis-based relaxation program
- **Christian Hypnobirthing** Scripture-based tracks
- **Headspace** pregnancy meditations

## 5. Spiritual Foundation

I engaged in Scripture memorization and reflection emphasizing divine design of birth and the body's natural capabilities. This spiritual preparation gave me peace and confidence.

## 6. Nutrition

I prioritized protein, choline-rich foods, potassium sources, whole foods, electrolytes, and prenatal supplementation. Nourishing my body well meant I felt strong going into labor.

## The Result

While every birth is unique and unpredictable, I felt prepared for whatever came my way. The work I did beforehand gave me tools to handle the intensity of labor and the confidence to advocate for myself.

If you're considering an unmedicated birth, know that preparation matters. It's not about being rigid in your plans—it's about building a foundation of knowledge, support, and trust in yourself.

Individual circumstances vary, and all birth types merit respect and validation.

*This article reflects personal experience and isn't medical advice. Always consult with your healthcare provider.*
    `
  },
  {
    slug: '2024-11-15-body-first-home',
    title: 'Your Body Is the First Home: Returning to the Foundations That Support Fertility and Pregnancy Health',
    date: '2024-11-15',
    author: 'Alicia',
    excerpt: 'You don\'t need perfection to prepare for pregnancy. Here are the six foundations that truly matter.',
    image: '/images/blog/body-first-home-new.jpeg',
    categories: ['preconception', 'foundations'],
    content: `
# Your Body Is the First Home

Before your baby has a nursery, before they have clothes or toys or a name picked out—they have your body. Your body is their first home.

You don't need perfection to prepare for pregnancy. What matters is returning to the foundations that support fertility and pregnancy health.

## The Six Preconception Foundations

### 1. Nourishment for Hormone & Blood Sugar Stability

Balanced nutrition means protein at breakfast, fiber, and sustained-energy snacks rather than restriction. Stable blood sugar creates a more stable hormonal environment, which supports fertility.

### 2. Mineral Replenishment

Modern life depletes our minerals. Focus on hydration, electrolytes, and mineral-rich foods. Hair Tissue Mineral Analysis (HTMA) provides a personalized assessment tool to understand your unique mineral status and imbalances.

### 3. Movement as Rhythm

Consistent physical activity matters more than intense exercise. Focus on gentle strength training, walking, stretching, and mobility work. Movement should feel like rhythm, not punishment.

### 4. Nervous System Regulation & Rest

Sleep and stress management have a profound impact on fertility and hormone balance. Honor your natural rhythms and incorporate practices like breathwork. Rest isn't optional—it's foundational.

### 5. Reducing Harmful Exposures

Small changes add up:
- Avoid microwaving in plastic containers
- Reduce synthetic fragrances
- Improve ventilation in your home

You don't need perfection here—just awareness and gradual improvements.

### 6. Prenatal Vitamins

Begin supplementation 3+ months before conception. I specifically recommend methylated folate (5-MTHF) rather than synthetic folic acid. The Needed brand is one I trust.

## Start Where You Are

You don't have to do everything at once. Pick one foundation and start there. Small, consistent changes add up to big transformations.

Your body is already incredible. These foundations just help it function at its best—for you and for your future little one.

With love + intention,
Alicia

*This article is for educational purposes only and is not medical advice. Clinical services at Intention Holistic Health PLLC are available only to Kentucky residents.*
    `
  },
  {
    slug: '2024-11-01-mental-health-pcos',
    title: 'May is Mental Health Awareness Month',
    date: '2024-05-01',
    author: 'Alicia',
    excerpt: 'Women with PCOS experience anxiety and depression 3x more often than women without the condition. Let\'s talk about practical ways to support your mental health.',
    image: '/images/blog/mental-health-pcos.png',
    categories: ['pcos'],
    content: `
# May is Mental Health Awareness Month

If you have PCOS, this is especially important for you to hear: your mental health matters, and the struggle is real.

## The Numbers Are Staggering

Research shows that women with PCOS:
- Are at an **8.5x higher risk of suicide attempt** than those without the condition
- Experience **anxiety and depression 3x more often** than women without PCOS

These aren't just statistics—they represent real women who are struggling.

## Nine Practical Mental Health Tips

### 1. Hydration
Consume half your body weight in ounces daily using remineralized water, herbal tea, or coconut water. Proper hydration affects brain function and mood.

### 2. Sleep
Aim for eight or more hours nightly. Before bed, journal your worries and reflect on five positive moments from your day.

### 3. Sunlight
Get 15 minutes of morning light exposure within 30 minutes of waking. This regulates your circadian rhythm and supports mood.

### 4. Blood Sugar Regulation
Eat protein and fats before carbs. Begin meals with protein, fat, and fiber to stabilize blood sugar and reduce mood swings.

### 5. Breathwork
Practice extended exhale breathing or square breathing techniques. Even a few minutes can shift your nervous system.

### 6. Grounding Exercises
Use the 5-4-3-2-1 sensory awareness method when feeling overwhelmed:
- 5 things you can see
- 4 things you can touch
- 3 things you can hear
- 2 things you can smell
- 1 thing you can taste

### 7. Vitamin D Optimization
Target levels above 60 with D3+K2 supplementation. Low vitamin D is linked to depression and is common in women with PCOS.

### 8. Omega-3 Supplementation
Consume low-mercury fish 2-3 times weekly or take quality omega-3 supplements. These support brain health and reduce inflammation.

### 9. Alcohol Awareness
Limit or eliminate alcohol consumption. Alcohol disrupts sleep, blood sugar, and hormone balance.

## You're Not Alone

If you're struggling with PCOS and mental health, please reach out—to a professional, a friend, or a support group. You don't have to carry this alone.

Want more tips? Download the complimentary **Holistic Habits Checklist** for additional wellness strategies.

*Clinical services available exclusively to Kentucky residents through formal provider-patient relationships.*
    `
  },
  {
    slug: '2024-10-15-probiotic-smoothie-bowl',
    title: 'Recipe: Probiotic-Rich Smoothie Bowl',
    date: '2024-10-15',
    author: 'Alicia',
    excerpt: 'A nutritious breakfast featuring coconut water, kefir, yogurt, flax seeds, and hemp hearts for digestive support.',
    image: '/images/blog/smoothie-bowl-cropped.webp',
    imageStyle: 'max-height: 400px; width: auto; margin: 0 auto; display: block;',
    cardImageStyle: 'object-position: left center;',
    categories: ['recipes', 'breakfast', 'pcos'],
    content: `
# Recipe: Probiotic-Rich Smoothie Bowl

Smoothies are a versatile delivery system for hidden nutrients and adaptogens. This probiotic-rich smoothie bowl supports digestive wellness while tasting delicious. Feel free to personalize the ratios and ingredients based on your preferences!

## Why This Recipe Works

This smoothie bowl is designed to support your gut microbiome with:
- **Probiotic content** from fermented sources like kefir and yogurt
- **Fiber** from seeds and vegetables
- **Protein** from dairy and plant sources
- **Beneficial fats** including omega-3s from hemp and flax
- **Hydration** from coconut water
- **Natural sweetness** from honey (optional)

## Ingredients

- 1 cup coconut water (pure ingredient only)
- 1/4 cup plain, full-fat kefir (optional)
- 3/4 cup organic Greek yogurt or dairy-free alternative
- 1 tablespoon flax seeds
- 1 tablespoon hemp hearts
- 1/2-1 cup frozen low-glycemic berries
- Handful frozen spinach or kale

### Optional Add-ins
- Collagen powder
- Protein powder
- Frozen cauliflower
- Honey or maple syrup (to taste)

### Toppings
- Fresh fruits
- Nuts
- Seeds
- Granola (try my Hormone-Friendly Granola recipe!)

## Instructions

1. Add coconut water, kefir, and yogurt to your blender
2. Add frozen berries, greens, flax seeds, and hemp hearts
3. Add any optional ingredients (collagen, protein powder, etc.)
4. Blend until smooth and creamy
5. Pour into a bowl
6. Add desired toppings
7. Enjoy immediately!

## Tips for Success

- Use frozen fruit for a thicker, creamier consistency
- Make sure your kefir and yogurt contain live active cultures
- The greens are undetectable in taste but add valuable nutrients
- Prep toppings ahead for busy mornings

This recipe is PCOS-friendly when made without added sugars and enjoyed as part of a balanced meal.
    `
  },
  {
    slug: '2024-10-01-gut-health-pcos',
    title: 'Gut Health and PCOS: The Missing Piece of the Puzzle',
    date: '2024-10-01',
    author: 'Alicia',
    excerpt: 'The trillions of microorganisms in your gut play crucial roles in hormone regulation and inflammation control. Understanding this connection is key to managing PCOS.',
    image: '/images/blog/gut-health-pcos-new.png',
    categories: ['pcos', 'foundations', 'htma'],
    content: `
# Gut Health and PCOS: The Missing Piece of the Puzzle

If you have PCOS, you've probably focused on hormones, blood sugar, and maybe even stress. But have you considered your gut health?

The trillions of microorganisms inhabiting your gut play crucial roles in hormone regulation and inflammation control. Understanding this connection is key to managing PCOS effectively.

## Four Key Impact Areas

### 1. Inflammation
Microbial imbalances may trigger chronic inflammation, contributing to insulin resistance—a core issue in PCOS.

### 2. Insulin Sensitivity
A balanced microbiota supports blood sugar regulation. When your gut is off, your blood sugar often is too.

### 3. Hormone Metabolism
Gut bacteria influence estrogen and testosterone processing. Your gut health directly affects your hormonal balance.

### 4. Mental Health
The gut-brain connection affects mood and anxiety. Many women with PCOS struggle with mental health, and gut health plays a role.

## Evidence-Based Recommendations

### Dietary Approaches
- Increase fiber intake from whole foods and vegetables
- Incorporate probiotic sources like yogurt and kombucha
- Focus on diverse plant foods to feed beneficial bacteria

### Lifestyle Modifications
- Regular exercise supports gut diversity
- Stress management techniques protect gut lining
- Adequate hydration supports digestion

### Supplementation
- Omega-3 fatty acids reduce inflammation
- Specific probiotic strains like Lactobacillus and Bifidobacterium species support gut health

## Listen to Your Body

Pay attention to bodily signals like bloating and skin changes as indicators of microbial health disruption. Your body is always communicating with you.

## The Bottom Line

Healing PCOS isn't just about hormones. It's about supporting all the systems that influence hormone health—and your gut is a big piece of that puzzle.

If you've been struggling with PCOS and haven't addressed gut health, this might be the missing piece you've been looking for.

If you're ready for personalized one-on-one coaching, I'd love to connect.

*This content is educational only and does not establish provider-patient relationships. Services available to Kentucky residents exclusively.*

## References
Research supporting these recommendations spans studies from 2016-2021 examining the gut-PCOS connection.
    `
  },
  {
    slug: '2024-09-15-hormone-friendly-granola',
    title: 'Recipe: Hormone-Friendly Granola',
    date: '2024-09-15',
    author: 'Alicia',
    excerpt: 'I often opt for grain-free granola for most clients because grains can sometimes exacerbate symptoms such as insulin resistance and inflammation.',
    image: '/images/blog/granola.png',
    categories: ['recipes', 'breakfast', 'pcos'],
    content: `
# Recipe: Hormone-Friendly Granola

I often opt for grain-free granola for most clients because grains can sometimes exacerbate symptoms such as insulin resistance and inflammation.

This nutrient-dense recipe emphasizes blood sugar stabilization and hormone support through wholesome, additive-free ingredients rather than processed store-bought options.

## Why This Granola is Different

Most store-bought granolas are loaded with refined sugars, inflammatory seed oils, and grains that can spike blood sugar. This recipe uses whole food ingredients that support hormonal balance.

## Ingredients

- 1 cup organic sprouted rolled oats (excludable for grain-free version)
- 1 cup chopped raw nuts (walnuts, almonds, cashews)
- 1/2 cup raw hulled pumpkin seeds
- 1/2 cup raw sunflower seeds
- 1/2 cup unsweetened shredded coconut
- 1/4 cup melted coconut oil
- 1/4 cup pure maple syrup or honey
- 1 teaspoon vanilla extract
- 1 teaspoon ground cinnamon
- Pinch of sea salt

## Instructions

1. Preheat oven to 300°F
2. In a large bowl, combine oats (if using), nuts, seeds, coconut, cinnamon, and salt
3. In a small bowl, whisk together melted coconut oil, maple syrup (or honey), and vanilla extract
4. Pour wet ingredients over dry ingredients and mix until everything is evenly coated
5. Spread the mixture in an even layer on a parchment-lined baking sheet
6. Bake for 25-30 minutes, stirring halfway through
7. Let cool completely on the pan (it will crisp up as it cools)
8. Store in an airtight container for up to two weeks

## How to Enjoy

- Top your smoothie bowl
- Add to yogurt
- Eat as a snack with a handful of berries
- Sprinkle on baked apples or pears

## Hormone-Supporting Benefits

- **Pumpkin seeds**: Rich in zinc for hormone production
- **Nuts**: Healthy fats for hormone synthesis
- **Cinnamon**: Helps with blood sugar regulation
- **No refined sugar**: Prevents insulin spikes
- **Coconut oil**: Provides stable energy

Enjoy this nourishing granola as part of your hormone-balancing lifestyle!
    `
  }
];

// -----------------------------------------
// UTILITY FUNCTIONS
// -----------------------------------------

// Simple markdown parser
function parseMarkdown(markdown) {
  let html = markdown;

  // Headers
  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');

  // Bold
  html = html.replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>');

  // Italic
  html = html.replace(/\*(.*?)\*/gim, '<em>$1</em>');

  // Lists
  html = html.replace(/^\- (.*$)/gim, '<li>$1</li>');

  // Wrap consecutive li elements in ul
  html = html.replace(/(<li>.*<\/li>\n?)+/gim, function(match) {
    return '<ul>' + match + '</ul>';
  });

  // Paragraphs (lines that don't start with < and aren't empty)
  html = html.split('\n').map(function(line) {
    line = line.trim();
    if (line && !line.startsWith('<') && !line.startsWith('#')) {
      return '<p>' + line + '</p>';
    }
    return line;
  }).join('\n');

  // Clean up empty paragraphs
  html = html.replace(/<p><\/p>/g, '');
  html = html.replace(/<p>\s*<\/p>/g, '');

  return html;
}

// Format date
function formatDate(dateString) {
  const options = { year: 'numeric', month: 'long', day: 'numeric' };
  return new Date(dateString).toLocaleDateString('en-US', options);
}

// -----------------------------------------
// BLOG LISTING PAGE
// -----------------------------------------

function renderBlogListing() {
  const blogPostsContainer = document.getElementById('blog-posts');
  if (!blogPostsContainer) return;

  // Sort posts by date (newest first)
  const sortedPosts = [...BLOG_POSTS].sort((a, b) => new Date(b.date) - new Date(a.date));

  // Render posts
  let html = '';
  sortedPosts.forEach(function(post) {
    const cardImgStyle = post.cardImageStyle ? ` style="${post.cardImageStyle}"` : '';
    html += `
      <article class="blog-card">
        <img src="${post.image}" alt="${post.title}" class="blog-card-image" loading="lazy"${cardImgStyle} onerror="this.src='/images/blog/placeholder.jpg'">
        <div class="blog-card-body">
          <p class="blog-card-date">${formatDate(post.date)}</p>
          <h2 class="blog-card-title">
            <a href="/blog/post.html?post=${post.slug}">${post.title}</a>
          </h2>
          <p class="blog-card-excerpt">${post.excerpt}</p>
          <a href="/blog/post.html?post=${post.slug}" class="blog-card-link">Continue Reading &rarr;</a>
        </div>
      </article>
    `;
  });

  blogPostsContainer.innerHTML = html;

  // Set up category filtering
  setupCategoryFiltering(sortedPosts);
}

function setupCategoryFiltering(posts) {
  const categoryLinks = document.querySelectorAll('.category-link');

  categoryLinks.forEach(function(link) {
    link.addEventListener('click', function(e) {
      e.preventDefault();

      // Update active state
      categoryLinks.forEach(function(l) { l.classList.remove('active'); });
      this.classList.add('active');

      const category = this.dataset.category;
      const blogPostsContainer = document.getElementById('blog-posts');

      // Filter posts
      let filteredPosts = posts;
      if (category !== 'all') {
        filteredPosts = posts.filter(function(post) {
          return post.categories.includes(category);
        });
      }

      // Re-render
      if (filteredPosts.length === 0) {
        blogPostsContainer.innerHTML = '<p class="loading-message">No posts found in this category.</p>';
      } else {
        let html = '';
        filteredPosts.forEach(function(post) {
          const cardImgStyle = post.cardImageStyle ? ` style="${post.cardImageStyle}"` : '';
          html += `
            <article class="blog-card">
              <img src="${post.image}" alt="${post.title}" class="blog-card-image" loading="lazy"${cardImgStyle} onerror="this.src='/images/blog/placeholder.jpg'">
              <div class="blog-card-body">
                <p class="blog-card-date">${formatDate(post.date)}</p>
                <h2 class="blog-card-title">
                  <a href="/blog/post.html?post=${post.slug}">${post.title}</a>
                </h2>
                <p class="blog-card-excerpt">${post.excerpt}</p>
                <a href="/blog/post.html?post=${post.slug}" class="blog-card-link">Continue Reading &rarr;</a>
              </div>
            </article>
          `;
        });
        blogPostsContainer.innerHTML = html;
      }
    });
  });
}

// -----------------------------------------
// SINGLE POST PAGE
// -----------------------------------------

function renderSinglePost() {
  const postContent = document.getElementById('post-content');
  if (!postContent) return;

  // Get post slug from URL
  const urlParams = new URLSearchParams(window.location.search);
  const postSlug = urlParams.get('post');

  if (!postSlug) {
    postContent.innerHTML = '<p>Post not found. <a href="/blog/">Return to blog</a></p>';
    return;
  }

  // Find the post
  const post = BLOG_POSTS.find(function(p) { return p.slug === postSlug; });

  if (!post) {
    postContent.innerHTML = '<p>Post not found. <a href="/blog/">Return to blog</a></p>';
    return;
  }

  // Update page title
  document.title = post.title + ' | Intention Holistic Health';

  // Update meta description
  const metaDescription = document.querySelector('meta[name="description"]');
  if (metaDescription) {
    metaDescription.setAttribute('content', post.excerpt);
  }

  // Render post header
  const postTitle = document.getElementById('post-title');
  if (postTitle) {
    postTitle.textContent = post.title;
  }

  const postMeta = document.getElementById('post-meta');
  if (postMeta) {
    postMeta.innerHTML = `
      <span class="post-date">${formatDate(post.date)}</span>
      <span class="post-author">By ${post.author}</span>
    `;
  }

  // Render featured image
  const postImage = document.getElementById('post-image');
  if (postImage) {
    const customStyle = post.imageStyle ? ` style="${post.imageStyle}"` : '';
    postImage.innerHTML = `<img src="${post.image}" alt="${post.title}" loading="lazy"${customStyle} onerror="this.parentElement.style.display='none'">`;
  }

  // Render content
  postContent.innerHTML = parseMarkdown(post.content);

  // Render tags
  const postTags = document.getElementById('post-tags');
  if (postTags && post.categories) {
    let tagsHtml = '';
    post.categories.forEach(function(category) {
      tagsHtml += `<span class="post-tag">${category}</span>`;
    });
    postTags.innerHTML = tagsHtml;
  }

  // Set up share buttons
  setupShareButtons(post);

  // Render related posts
  renderRelatedPosts(post);
}

function renderRelatedPosts(currentPost) {
  const relatedPostsGrid = document.querySelector('.related-posts-grid');
  if (!relatedPostsGrid) return;

  // Find posts with matching categories, excluding current post
  let relatedPosts = BLOG_POSTS.filter(function(post) {
    if (post.slug === currentPost.slug) return false;

    // Check if any categories match
    return post.categories.some(function(category) {
      return currentPost.categories.includes(category);
    });
  });

  // If not enough related posts, add other posts
  if (relatedPosts.length < 3) {
    const otherPosts = BLOG_POSTS.filter(function(post) {
      return post.slug !== currentPost.slug && !relatedPosts.includes(post);
    });
    relatedPosts = relatedPosts.concat(otherPosts);
  }

  // Limit to 3 posts
  relatedPosts = relatedPosts.slice(0, 3);

  // Render the related posts
  let html = '';
  relatedPosts.forEach(function(post) {
    html += `
      <a href="/blog/post.html?post=${post.slug}" class="related-post-card">
        <img src="${post.image}" alt="${post.title}" loading="lazy" onerror="this.src='/images/blog/placeholder.jpg'">
        <div class="related-post-card-body">
          <p class="related-post-card-title">${post.title}</p>
        </div>
      </a>
    `;
  });

  relatedPostsGrid.innerHTML = html;
}

function setupShareButtons(post) {
  const pageUrl = encodeURIComponent(window.location.href);
  const rawUrl = window.location.href;
  const pageTitle = encodeURIComponent(post.title);
  const rawTitle = post.title;

  // Copy Link button
  const copyLinkBtn = document.getElementById('copy-link');
  const copyConfirmation = document.getElementById('copy-confirmation');
  if (copyLinkBtn) {
    copyLinkBtn.addEventListener('click', function() {
      navigator.clipboard.writeText(rawUrl).then(function() {
        copyConfirmation.classList.add('show');
        setTimeout(function() {
          copyConfirmation.classList.remove('show');
        }, 2000);
      }).catch(function() {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = rawUrl;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        copyConfirmation.classList.add('show');
        setTimeout(function() {
          copyConfirmation.classList.remove('show');
        }, 2000);
      });
    });
  }

  // Email share
  const emailBtn = document.getElementById('share-email');
  if (emailBtn) {
    const emailSubject = encodeURIComponent('Check out this article: ' + rawTitle);
    const emailBody = encodeURIComponent('I thought you might find this helpful:\n\n' + rawTitle + '\n\n' + rawUrl);
    emailBtn.href = `mailto:?subject=${emailSubject}&body=${emailBody}`;
  }

  const facebookBtn = document.getElementById('share-facebook');
  if (facebookBtn) {
    facebookBtn.href = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
  }

  const twitterBtn = document.getElementById('share-twitter');
  if (twitterBtn) {
    twitterBtn.href = `https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`;
  }

  const pinterestBtn = document.getElementById('share-pinterest');
  if (pinterestBtn) {
    const imageUrl = encodeURIComponent(window.location.origin + post.image);
    pinterestBtn.href = `https://pinterest.com/pin/create/button/?url=${pageUrl}&media=${imageUrl}&description=${pageTitle}`;
  }
}

// -----------------------------------------
// INITIALIZE
// -----------------------------------------

document.addEventListener('DOMContentLoaded', function() {
  // Check which page we're on and initialize accordingly
  if (document.getElementById('blog-posts')) {
    renderBlogListing();
  } else if (document.getElementById('post-content')) {
    renderSinglePost();
  }
});
